<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>주일설교 - 물댄동산교회</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../styles.css">
    <style>
        .page-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 60px 0 40px;
            text-align: center;
            margin-top: 0;
        }
        
        .sermon-item {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .sermon-item:hover {
            transform: translateY(-5px);
        }
        
        .sermon-content {
            padding: 25px;
        }
        
        .sermon-meta {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .sermon-excerpt {
            color: #333;
            line-height: 1.6;
            margin-bottom: 20px;
        }
        
        .sermon-actions {
            display: flex;
            gap: 10px;
        }
        
        .sermon-actions a {
            color: #dc3545;
            text-decoration: none;
            font-size: 14px;
            transition: color 0.3s ease;
        }
        
        .sermon-actions a:hover {
            color: #c82333;
        }
        
        .sidebar-widget {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
        }
        
        .sidebar-widget h4 {
            color: #333;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        .category-list {
            list-style: none;
            padding: 0;
        }
        
        .category-list li {
            margin-bottom: 10px;
        }
        
        .category-list a {
            color: #666;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .category-list a:hover {
            color: #dc3545;
        }
        
        .recent-post {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .recent-post:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .recent-post img {
            width: 60px;
            height: 45px;
            border-radius: 5px;
            margin-right: 15px;
            object-fit: cover;
        }
        
        .recent-post-info h5 {
            font-size: 0.9rem;
            margin-bottom: 5px;
            color: #333;
        }
        
        .recent-post-info p {
            font-size: 0.8rem;
            color: #666;
            margin: 0;
        }
        
        /* YouTube Video Container Styles */
        .video-container {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 비율 */
            height: 0;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 15px;
        }
        
        /* YouTube Link Styles */
        .sermon-actions a {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: #ff0000;
            color: white !important;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .sermon-actions a:hover {
            background: #cc0000;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255,0,0,0.3);
        }
        
        .sermon-actions a i {
            font-size: 1.2rem;
        }
        
        /* 썸네일 이미지 스타일 */
        .sermon-content .row {
            align-items: center;
        }
        
        .sermon-content img {
            transition: transform 0.3s ease;
        }
        
        .sermon-content img:hover {
            transform: scale(1.05);
        }
        
        /* 로딩 스피너 스타일 */
        .spinner-border {
            width: 3rem;
            height: 3rem;
        }
    </style>
</head>
<body>
    <!-- Header Container -->
    <div id="header-container"></div>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="display-4 mb-3">주일설교</h1>
                    <p class="lead">하나님의 말씀을 통해 은혜를 받으세요</p>
                </div>
            </div>
        </div>
    </section>

    <!-- YouTube Playlist Section -->
    <section class="py-5">
        <div class="container">
            <div class="row">
                <div class="col-12">
                                         <h2 class="text-center mb-5">최신 설교 영상</h2>
                    <div class="video-container">
                        <iframe width="100%" height="600" 
                                src="https://www.youtube.com/embed/videoseries?list=PLuyd60PWgGd2rEYGrUkFLffSaQZDjOd1H&autoplay=0" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="text-center mt-4">
                        <p class="text-muted">위 재생목록에 새로운 설교 영상이 자동으로 추가됩니다.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <section class="py-5 bg-light">
        <div class="container">
            <div class="row">
                <!-- Main Content -->
                <div class="col-lg-8">
                    <h3 class="mb-4">최근 설교 소개</h3>
                    <div id="sermon-list">
                        <!-- 여기에 동적으로 YouTube 재생목록의 영상들이 로드됩니다 -->
                        <div class="text-center">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="mt-3">설교 목록을 불러오는 중...</p>
                        </div>
                    </div>
                </div>

                <!-- Sidebar -->
                <div class="col-lg-4">
                    <div class="sidebar-widget">
                        <h4>최근 쇼츠</h4>
                        <div id="shorts-list">
                            <!-- 여기에 동적으로 YouTube 쇼츠가 로드됩니다 -->
                            <div class="text-center">
                                <div class="spinner-border text-primary" role="status" style="width: 1.5rem; height: 1.5rem;">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                                <p class="mt-2 small text-muted">쇼츠를 불러오는 중...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Container -->
    <div id="footer-container"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../script.js"></script>
    <script src="../footer-loader.js"></script>
    <script src="../header-loader.js"></script>
    
    <script>
    // YouTube 재생목록에서 영상 정보를 가져오는 함수
    async function loadSermonList() {
        const PLAYLIST_ID = 'PLuyd60PWgGd2rEYGrUkFLffSaQZDjOd1H';
        const sermonList = document.getElementById('sermon-list');
        
        try {
            // RSS2JSON API를 사용하여 재생목록 정보 가져오기
            const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(`https://www.youtube.com/feeds/videos.xml?playlist_id=${PLAYLIST_ID}`)}`);
            const data = await response.json();
            
            if (data.status === 'ok' && data.items && data.items.length > 0) {
                // 최신 영상을 상단 플레이어에 표시
                const latestVideo = data.items[0];
                const latestVideoId = latestVideo.link.split('v=')[1];
                
                // 상단 플레이어 업데이트
                const videoContainer = document.querySelector('.video-container iframe');
                if (videoContainer) {
                    videoContainer.src = `https://www.youtube.com/embed/${latestVideoId}?autoplay=0`;
                }
                
                let html = '';
                
                // 최대 5개까지만 표시
                const itemsToShow = data.items.slice(0, 5);
                
                itemsToShow.forEach(item => {
                    const videoId = item.link.split('v=')[1];
                    const title = item.title;
                    const published = new Date(item.pubDate).toLocaleDateString('ko-KR');
                    const description = item.description;
                    const thumbnail = item.thumbnail;
                    
                    const excerpt = description.length > 100 ? description.substring(0, 100) + '...' : description;
                    
                    html += `
                        <div class="sermon-item">
                            <div class="sermon-content">
                                <div class="row">
                                    <div class="col-md-3">
                                        <img src="${thumbnail}" alt="${title}" class="img-fluid rounded" style="width: 100%; height: 120px; object-fit: cover;">
                                    </div>
                                    <div class="col-md-9">
                                        <h4>${title}</h4>
                                        <div class="sermon-meta">
                                            Posted on ${published}, Pastor: 정종한 목사
                                        </div>
                                        <div class="sermon-excerpt">
                                            ${excerpt}
                                        </div>
                                        <div class="sermon-actions">
                                            <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank">
                                                <i class="fab fa-youtube"></i> YouTube에서 보기
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                sermonList.innerHTML = html;
            } else {
                // RSS 피드가 실패한 경우 기본 메시지 표시
                sermonList.innerHTML = `
                    <div class="text-center">
                        <p class="text-muted">재생목록의 영상을 불러올 수 없습니다.</p>
                        <p class="text-muted">위의 재생목록 플레이어에서 직접 영상을 확인해주세요.</p>
                    </div>
                `;
            }
            
        } catch (error) {
            console.error('RSS 피드 오류:', error);
            // 오류 발생 시 기본 메시지 표시
            sermonList.innerHTML = `
                <div class="text-center">
                    <p class="text-muted">재생목록의 영상을 불러올 수 없습니다.</p>
                    <p class="text-muted">위의 재생목록 플레이어에서 직접 영상을 확인해주세요.</p>
                </div>
            `;
        }
    }
    
    // YouTube 쇼츠를 가져오는 함수
    async function loadShortsList() {
        const CHANNEL_ID = 'UCuyd60PWgGd2rEYGrUkFLffSaQZDjOd1H'; // 물댄동산교회 채널 ID
        const shortsList = document.getElementById('shorts-list');
        
        try {
            // 채널의 최근 영상들을 가져와서 쇼츠로 표시 (실제 쇼츠는 API 키가 필요)
            const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(`https://www.youtube.com/feeds/videos.xml?channel_id=${CHANNEL_ID}`)}`);
            const data = await response.json();
            
            if (data.status === 'ok' && data.items && data.items.length > 0) {
                let html = '';
                
                // 최대 3개까지만 표시
                const itemsToShow = data.items.slice(0, 3);
                
                itemsToShow.forEach(item => {
                    const videoId = item.link.split('v=')[1];
                    const title = item.title;
                    const published = new Date(item.pubDate).toLocaleDateString('ko-KR');
                    const thumbnail = item.thumbnail;
                    
                    // 제목이 너무 길면 줄이기
                    const shortTitle = title.length > 30 ? title.substring(0, 30) + '...' : title;
                    
                    html += `
                        <div class="recent-post">
                            <img src="${thumbnail}" alt="${title}" style="width: 80px; height: 60px; object-fit: cover;">
                            <div class="recent-post-info">
                                <h5>${shortTitle}</h5>
                                <p>${published}</p>
                                <a href="https://www.youtube.com/shorts/${videoId}" target="_blank" class="btn btn-sm btn-outline-danger">
                                    <i class="fab fa-youtube"></i> 쇼츠 보기
                                </a>
                            </div>
                        </div>
                    `;
                });
                
                shortsList.innerHTML = html;
            } else {
                // RSS 피드가 실패한 경우 기본 메시지 표시
                shortsList.innerHTML = `
                    <div class="text-center">
                        <p class="small text-muted">쇼츠를 불러올 수 없습니다.</p>
                        <p class="small text-muted">
                            <a href="https://www.youtube.com/@mdds/shorts" target="_blank" class="btn btn-sm btn-outline-danger">
                                <i class="fab fa-youtube"></i> 쇼츠 채널 바로가기
                            </a>
                        </p>
                    </div>
                `;
            }
            
        } catch (error) {
            console.error('쇼츠 로딩 오류:', error);
            // 오류 발생 시 기본 메시지 표시
            shortsList.innerHTML = `
                <div class="text-center">
                    <p class="small text-muted">쇼츠를 불러올 수 없습니다.</p>
                    <p class="small text-muted">
                        <a href="https://www.youtube.com/@mdds/shorts" target="_blank" class="btn btn-sm btn-outline-danger">
                            <i class="fab fa-youtube"></i> 쇼츠 채널 바로가기
                        </a>
                    </p>
                </div>
            `;
        }
    }
    

    
    // 페이지 로드 시 실행
    document.addEventListener('DOMContentLoaded', function() {
        loadSermonList();
        loadShortsList();
    });
    </script>
</body>
</html>
